version: "3"
services:

  elasticsearch:
    container_name: subsocial_es_cluster
    image: docker.elastic.co/elasticsearch/elasticsearch:7.4.1
    restart: always
    environment:
      ES_JAVA_OPTS: "-Xms512m -Xmx512m"
      MAX_MAP_COUNT: "64000"
      discovery.type: "single-node"
      cluster.name: "subsocial-cluster"
      node.name: "subsocial-node"
      network.host: "172.15.0.5"
      http.port: "9200"
      http.cors.enabled: "true"
      http.cors.allow-credentials: "true"
      http.cors.allow-origin: "172.15.0.1:3000,172.15.0.3"
      http.cors.allow-headers: "X-Requested-With,X-Auth-Token,Content-Type,Content-Length,Authorization,Access-Control-Allow-Headers,Accept"
    volumes:
      - es_data:/usr/share/elasticsearch/data
    networks:
      backend:
        ipv4_address: 172.15.0.5
